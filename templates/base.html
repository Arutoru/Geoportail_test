<!DOCTYPE html>
{% load static %}
{% load leaflet_tags %}
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    {% leaflet_js %}
    {% leaflet_css %}
    <!-- Load static css -->
    <link rel="stylesheet" href="{% static "css/style.css" %}"/>
    <script type="text/javascript" src="{% static "routing/leaflet-routing-machine.js" %}"></script>
    <link rel="stylesheet" href="{% static "routing/leaflet-routing-machine.css" %}"/>
    <!-- Load Esri Leaflet Geocoder from CDN -->
    <link rel="stylesheet" href="https://unpkg.com/esri-leaflet-geocoder@2.3.2/dist/esri-leaflet-geocoder.css"
      integrity="sha512-IM3Hs+feyi40yZhDH6kV8vQMg4Fh20s9OzInIIAc4nx7aMYMfo+IenRUekoYsHZqGkREUgx0VvlEsgm7nCDW9g=="
      crossorigin="">
    <!-- Load Esri Leaflet from CDN -->
    <script src="https://unpkg.com/esri-leaflet@2.3.2/dist/esri-leaflet.js"
    integrity="sha512-6LVib9wGnqVKIClCduEwsCub7iauLXpwrd5njR2J507m3A2a4HXJDLMiSZzjcksag3UluIfuW1KzuWVI5n/cuQ=="
    crossorigin=""></script>
    <script src="https://unpkg.com/esri-leaflet-geocoder@2.3.2/dist/esri-leaflet-geocoder.js"
      integrity="sha512-8twnXcrOGP3WfMvjB0jS5pNigFuIWj4ALwWEgxhZ+mxvjF5/FBPVd5uAxqT8dd2kUmTVK9+yQJ4CmTmSg/sXAQ=="
      crossorigin=""></script>
    <!-- Latest compiled Bootsrtap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
    integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <!-- Alternative to Bootstrap 3 Glyphicons -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

    <title>Our home</title>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light d-flex justify-content-center">
      {% if user.is_authenticated and user.is_staff %}
        <ul class="d-flex flex-row navbar-nav mr-auto">
          <li><a class="navbar-brand" href="{% url 'home' %}">GEOSPACE</a></li>
          <li><a class="btn btn-primary" href="{% url 'admin:index' %}">Admin</a></li>
        </ul>
      {% elif user.is_authenticated %}
        <ul class="navbar-nav mr-auto">
          <li><a class="navbar-brand" href="{% url 'home' %}">GEOSPACE</a></li>
        </ul>
        <button type="button" id="dwn-btn" class="btn btn-success mx-2"> Télécharger les données</button>
      {% else %}
        <ul class="navbar-nav mr-auto">
          <li><a class="navbar-brand" href="{% url 'home' %}">GEOSPACE</a></li>
          <li><a class=" my-2 my-sm-0" href="{% url 'login' %}" aria-label="Login">
            <span class="fa fa-user fa-2x" aria-hidden="true"></span>
          </a></li>
        </ul>
      {% endif %}
      <div class="dropdown">
        <a class="btn btn-info dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Liste des projets
        </a>
        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
          <a class="dropdown-item active" href="#">PROJECT TOPIC 1</a>
          <a class="dropdown-item" href="#">PROJECT TOPIC 2</a>
          <a class="dropdown-item" href="#">PROJECT TOPIC 3</a>
        </div>
      </div>
    </nav>

    {% block content %}
    {% endblock %}
    <section class="d-flex flex-column flex-lg-row container-fluid">

      <div class="col-lg-2 list-group">
        <div class="card text-white" data-aos="zoom-in" data-aos-delay="200">
          <img class="card-img" src="{% static "Img1.jpg" %}" alt="Card image">
          <a href="#" class="list-group-item list-group-item-action active" aria-current="true">
            <h6 class="mb-1">PROJECT TOPIC 1</h6>
            <p class="mb-1">This is where to put the title of the project</p>
            <div class="d-flex w-100 justify-content-between">
              <small>reference of the project</small>
              <small>1 jan 2010</small>
            </div>
          </a>
        </div>
        <div class="card text-white">
          <img class="card-img" src="{% static "Img1.jpg" %}" alt="Card image">
          <a href="#" class="list-group-item list-group-item-action">
            <h6 class="mb-1">PROJECT TOPIC 2</h6>
            <p class="mb-1">This is where to put the title of the project</p>
            <div class="d-flex w-100 justify-content-between">
              <small>reference of the project</small>
              <small>1 jan 2010</small>
            </div>
          </a>
        </div>
        <div class="card text-white">
          <img class="card-img" src="{% static "Img1.jpg" %}" alt="Card image">
          <a href="#" class="list-group-item list-group-item-action">
            <h6 class="mb-1">PROJECT TOPIC 3</h6>
            <p class="mb-1">This is where to put the title of the project</p>
            <div class="d-flex w-100 justify-content-between">
              <small>reference of the project</small>
              <small>1 jan 2010</small>
            </div>
          </a>
        </div>
      </div>

      <div class="col-lg-7 container" id="map">
        <h2 class = "popup">THIS IS WHERE TO PUT THE TITLE OF THE PROJECT</h2><br>
        {% leaflet_map "detailmap" callback="window.map_init"%}
        {% block javascript %}
        {{ block.super }}

        {% endblock %}
      </div>

      <div class="col-lg-3" id="accordion">
        <div class="card">
          <div class="card-header" id="headingOne">
            <h5 class="mb-0">
              <button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                Resumé
              </button>
            </h5>
          </div>
          <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion">
            <div class="card-body">
              Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on it squid single-origin coffee nulla assumenda shoreditch et. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident. Ad vegan excepteur butcher vice lomo. Leggings occaecat craft beer farm-to-table, raw denim aesthetic synth nesciunt you probably haven't heard of them accusamus labore sustainable VHS.
            </div>
          </div>
        </div>
        <div class="card">
          <div class="card-header" id="headingTwo">
            <h5 class="mb-0 flex-column flex-md-row">
              <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                Couches
              </button>
              {% if user.is_authenticated %}
                <button type="button" id="dwn-btn" class="btn btn-success mx-2">
                  Télécharger <span class="fa fa-download fa-1x" aria-hidden="true"></span>
                </button>
              {% else %}
              <button type="button" id="dwn-btn" class="btn btn-success mx-2" disabled>
                Télécharger <span class="fa fa-download fa-1x" aria-hidden="true"></span>
              </button>
              {% endif %}
            </h5>
          </div>
          <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
            <div class="d-flex justify-content-center">
              <small><i>Sélectionnez ci-dessous les couches à télécharger</i></small>
            </div>
            <div class="card-body">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="Region" id="defaultCheck1" checked>
                <label class="form-check-label" for="defaultCheck1">
                  Region
                </label>
              </div>
              <br/>
              <div class="form-check">
                <input  class="form-check-input" type="checkbox" value="Borne" id="defaultCheck2" checked>
                <label class="form-check-label" for="defaultCheck2">
                  Borne
                </label>
                <img width="30" src="http://static.arcgis.com/images/Symbols/NPS/npsPictograph_0231b.png" alt="..." class="rounded float-right">
              </div>

            </div>
          </div>
        </div>
        <div class="card">
          <div class="card-header" id="headingThree">
            <h5 class="mb-0">
              <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                Images
              </button>
            </h5>
          </div>
          <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
            <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
              <ol class="carousel-indicators">
                <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
              </ol>
              <div class="carousel-inner">
                <div class="carousel-item active">
                  <img class="d-block w-100" src="{% static "ImgPro1.jpg" %}" alt="First slide">
                </div>
                <div class="carousel-item">
                  <img class="d-block w-100" src="{% static "ImgPro2.jpg" %}" alt="Second slide">
                </div>
                <div class="carousel-item">
                  <img class="d-block w-100" src="{% static "ImgPro3.jpg" %}" alt="Third slide">
                </div>
              </div>
              <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
              </a>
              <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
              </a>
            </div>
          </div>
        </div>
        <div class="card">
          <div class="card-header" id="headingFour">
            <h5 class="mb-0">
              <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                Outils
              </button>
            </h5>
          </div>
          <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordion">
            <div class="card-body">
              <button type="button" id="dwn-btn2" class="btn btn-success mx-2">
                Réinitialiser la recherche <span class="fa fa-refresh fa-1x" aria-hidden="true"></span>
              </button>
            </div>
          </div>
        </div>
        <div class="card">
          <div class="card-header" id="headingFive">
            <h5 class="mb-0">
              <button class="btn btn-link" data-toggle="collapse" data-target="#collapseFive" aria-expanded="true" aria-controls="collapseFive">
                Documents
              </button>
            </h5>
          </div>
          <div id="collapseFive" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion">
            <div class="card-body">
            </div>
          </div>
        </div>
      </div>
   </section>
  </body>

  <footer>
    <p> <b>Réalisé par </b><a href="https://www.linkedin.com/in/arthur-tankwa-1774bb170/" target = "_blank">Arthur Tankwa</a></p>
  </footer>

  {# Plugins#}
  <!-- Latest compiled and minified jQuery -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
  <!-- Latest compiled and minified JavaScript -->
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
  <script type="text/javascript">

    // Download layers which are selected
    // Retrieve all layers
    var layers = document.getElementsByClassName('form-check-input');
    var places = document.getElementsByClassName('leaflet-marker-draggable');
    // Start file download.
    document.getElementById("dwn-btn").addEventListener("click", function(){
      // Retrieve the index of all layers to be download
      var listId = new Array();
      for (let i=0, c=layers.length; i<c; i++){
        if (layers[i].checked){
          listId.push(i);
        }
      };
      // Retrieve the JSON files of the corresponding layers
      i=0;
      files.map(file => file.then(data => {
        if (listId.includes(i)){
          console.log(data);
          text = JSON.stringify(data);
          var filename = dataurls[i]+ ".geosjon";
          download(filename, text);
        };
        // var text = document.getElementsByTagName("a").value;
        i++
      }));
    }, false);


  </script>
</html>
